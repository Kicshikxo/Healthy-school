generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id         String   @id(map: "user_pkey") @map("user_id") @db.Char(8)
    role       Role     @map("role")
    username   String   @unique @map("username") @db.VarChar(64)
    password   String   @map("password") @db.Char(60)
    secondName String   @map("second_name") @db.VarChar(64)
    firstName  String   @map("first_name") @db.VarChar(64)
    middleName String   @map("middle_name") @db.VarChar(64)
    createdAt  DateTime @default(now()) @map("created_at")
    updatedAt  DateTime @updatedAt @map("updated_at")

    @@map("users")
}

model Student {
    id         String   @id(map: "children_pkey") @map("student_id") @db.Char(8)
    snils      String   @unique @map("snils") @db.Char(14)
    secondName String   @map("second_name") @db.VarChar(64)
    firstName  String   @map("first_name") @db.VarChar(64)
    middleName String   @map("middle_name") @db.VarChar(64)
    age        Int      @map("age")
    class      String   @map("class") @db.VarChar(64)
    createdAt  DateTime @default(now()) @map("created_at")
    updatedAt  DateTime @updatedAt @map("updated_at")

    physicalHealth PhysicalHealth?
    medicalHealth  MedicalHealth?
    socialHealth   SocialHealth?

    @@map("students")
}

model PhysicalHealth {
    studentId                 String       @id(map: "physical_health_pkey") @map("student_id") @db.Char(8)
    student                   Student      @relation(fields: [studentId], references: [id])
    healthGroup               HealthGroup? @map("health_group")
    individualRecommendations String[]     @map("individual_recommendations")
    specialistRecommendations String?      @map("specialist_recommendations")

    @@map("physical_health")
}

model MedicalHealth {
    studentId String  @id(map: "medical_health_pkey") @map("student_id") @db.Char(8)
    student   Student @relation(fields: [studentId], references: [id])

    @@map("medical_health")
}

model SocialHealth {
    studentId                 String   @id(map: "social_health_pkey") @map("student_id") @db.Char(8)
    student                   Student  @relation(fields: [studentId], references: [id])
    indicators                Int[]    @map("indicators")
    individualRecommendations String[] @map("individual_recommendations")

    @@map("social_health")
}

model SocialHealthIndicator {
    id         Int        @id(map: "social_health_indicators_pkey") @default(autoincrement()) @map("indicator_id")
    title      String     @map("title")
    healthZone HealthZone @map("health_zone")

    @@map("social_health_indicators")
}

enum Role {
    OPERATOR
    CLASS_TEACHER
    HEALTH_WORKER
    SOCIAL_PEDAGOGUE
    PSYCHOLOGIST
    PHYSICAL_EDUCATION_TEACHER
}

enum HealthGroup {
    BASIC
    PREPARATORY
    SPECIAL
}

enum HealthZone {
    GREEN
    YELLOW
    RED
}
